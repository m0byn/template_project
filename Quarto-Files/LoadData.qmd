---
title: "LoadData"
author: "Manuel Zerobin"
format:
    html:
      toc: true
      toc-location: right-body
      code-fold: true
      code-tools: true
editor: source
toc: true
---

# Project

-   Official project name

# Task

-   Import data and merge them into datasets which are used in other files. The data is saved to .arrow and .parquet and should be imported in other quarto files.

# Notes

- here is some space for general notes

## topic specific notes

-   bla bla

## Path to data

-   Write location '//int.wsr.at/Nabu/ohne_Backup/mzerobin/PROJECTNAME/BaseData/XXX.arrow' or
-   Write location '//int.wsr.at/Nabu/ohne_Backup/mzerobin/PROJECTNAME/BaseData/XXX.parquet' or
-   Write location '//int.wsr.at/Nabu/ohne_Backup/mzerobin/PROJECTNAME/BaseData/XXX.fst'

# Load relevant functions and packages

```{r loadPackages}
#| message: false
#| warning: false
library(here) # load here package for relative paths
library(wifo.base) # separately load wifo.base

source(here('R-Scripts', 'Functions.R')) # source relevant functions

package_verification(packages = c('tidyverse', 
                                  'collapse',
                                  'lubridate',
                                  'arrow',
                                  'data.table',
                                  'parallel',
                                  'fst',
                                  'dtplyr'), 
                     type = 'script')
```

Set seed, just in case

```{r setSeed}
set.seed(123456789)
```

# Load data

```{r loadData}
# Draw sample if needed:

# pfif.app = open_dataset(file.path('//int.wsr.at/Nabu/ohne_Backup/OeNB-Jubelfonds-Pflege-Gesundheit/PFIF-WIFO/Auswertung_Antragsdaten.parquet'))
# samp = sample(nrow(pfif.app), 10000)
# pfif.app = pfif.app[samp,] %>% collect(); invisible(gc())

pfif.app.raw = as.data.table(read_parquet(file.path('//int.wsr.at/Nabu/ohne_Backup/OeNB-Jubelfonds-Pflege-Gesundheit/PFIF-WIFO/Auswertung_Antragsdaten.parquet'))); invisible(gc())
pfif.trans.raw = as.data.table(read_parquet(file.path('//int.wsr.at/Nabu/ohne_Backup/OeNB-Jubelfonds-Pflege-Gesundheit/PFIF-WIFO/Auswertung_Auszahlungsdaten.parquet'))); invisible(gc())
pfif.hvis.raw = as.data.table(read_parquet(file.path('//int.wsr.at/Nabu/ohne_Backup/OeNB-Jubelfonds-Pflege-Gesundheit/PFIF-WIFO/Auswertung_Hausbesuchsdaten.parquet'))); invisible(gc())
```
